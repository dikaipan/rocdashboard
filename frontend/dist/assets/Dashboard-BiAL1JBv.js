const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FullscreenChartModal-BlV1ZmyP.js","assets/vendor-react-DhTDDHjY.js","assets/vendor-maps-C_U1R0uQ.js","assets/vendor-maps-Dgihpmma.css","assets/SkillProgress-CpQTq6g-.js","assets/index-DmJzWoJv.js","assets/index-Ut0mWwGH.css","assets/useEngineerData-CH_O1yHW.js","assets/indonesia-prov-BRgqRgcB.js","assets/useMachineKPIs-C0JF2Ok6.js","assets/textUtils-DatDPYXU.js","assets/PageLayout-I56-JVwe.js"])))=>i.map(i=>d[i]);
import{u as Je,L as rt,c as O,T as A,g as le,a as ke,_ as lt}from"./index-DmJzWoJv.js";import{R as it,r as l,j as e,o as ot,p as ct,q as dt,u as xt,s as J,t as ge,v as _,w as pe,x as F,y as ht,z as fe,A as be,Y as ie,X as we,D as je}from"./vendor-react-DhTDDHjY.js";import{u as mt,a as ut,b as gt,c as pt}from"./useEngineerData-CH_O1yHW.js";import{i as ft,u as bt}from"./indonesia-prov-BRgqRgcB.js";import{u as jt}from"./useMachineKPIs-C0JF2Ok6.js";import{S as Nt}from"./SkillProgress-CpQTq6g-.js";import{L as vt}from"./vendor-maps-C_U1R0uQ.js";import{n as yt,t as At,a as Oe}from"./textUtils-DatDPYXU.js";import{P as kt}from"./PageLayout-I56-JVwe.js";const wt=JSON.parse(ft),ze={Jakarta:"DKI JAKARTA","Jakarta Pusat":"DKI JAKARTA","Jakarta Selatan":"DKI JAKARTA","Jakarta Barat":"DKI JAKARTA","Jakarta Timur":"DKI JAKARTA","Jakarta Utara":"DKI JAKARTA",Bandung:"JAWA BARAT",Bogor:"JAWA BARAT",Depok:"JAWA BARAT",Bekasi:"JAWA BARAT",Cirebon:"JAWA BARAT",Tasikmalaya:"JAWA BARAT",Sukabumi:"JAWA BARAT",Cikampek:"JAWA BARAT",Cianjur:"JAWA BARAT",Kuningan:"JAWA BARAT",Semarang:"JAWA TENGAH",Solo:"JAWA TENGAH",Yogyakarta:"DAERAH ISTIMEWA YOGYAKARTA",Tegal:"JAWA TENGAH",Purwokerto:"JAWA TENGAH",Pekalongan:"JAWA TENGAH",Madiun:"JAWA TENGAH",Blora:"JAWA TENGAH",Klaten:"JAWA TENGAH",Jepara:"JAWA TENGAH","Madiun (Bojonegoro)":"JAWA TENGAH",Surabaya:"JAWA TIMUR",Malang:"JAWA TIMUR",Jember:"JAWA TIMUR",Kediri:"JAWA TIMUR",Banyuwangi:"JAWA TIMUR",Probolinggo:"JAWA TIMUR",Pamekasan:"JAWA TIMUR",Bangkalan:"JAWA TIMUR",Tangerang:"BANTEN",Serang:"BANTEN",Medan:"SUMATERA UTARA","Pematang Siantar":"SUMATERA UTARA",Tarutung:"SUMATERA UTARA","Rantau Prapat":"SUMATERA UTARA",Padang:"SUMATERA BARAT",Payakumbuh:"SUMATERA BARAT",Palembang:"SUMATERA SELATAN",Lahat:"SUMATERA SELATAN",Lubuklinggau:"SUMATERA SELATAN",Pekanbaru:"RIAU",Dumai:"RIAU",Tembilahan:"RIAU",Batam:"KEPULAUAN RIAU",Bintan:"KEPULAUAN RIAU",Lampung:"LAMPUNG",Kotabumi:"LAMPUNG",Jambi:"JAMBI",Bengkulu:"BENGKULU",Aceh:"DI. ACEH",Bangka:"BANGKA BELITUNG",Belitung:"BANGKA BELITUNG",Pontianak:"KALIMANTAN BARAT",Ketapang:"KALIMANTAN BARAT",Sanggau:"KALIMANTAN BARAT",Palangkaraya:"KALIMANTAN TENGAH","Pangkalan Bun":"KALIMANTAN TENGAH",Banjarmasin:"KALIMANTAN SELATAN",Balikpapan:"KALIMANTAN TIMUR",Samarinda:"KALIMANTAN TIMUR",Berau:"KALIMANTAN TIMUR",Tarakan:"KALIMANTAN UTARA",Manado:"SULAWESI UTARA",Palu:"SULAWESI TENGAH","Palu/Luwuk":"SULAWESI TENGAH",Makassar:"SULAWESI SELATAN","Pare Pare":"SULAWESI SELATAN",Palopo:"SULAWESI SELATAN",Bulukumba:"SULAWESI SELATAN",Kendari:"SULAWESI TENGGARA",Gorontalo:"GORONTALO",Ambon:"MALUKU",Ternate:"MALUKU UTARA",Timika:"PAPUA",Jayapura:"PAPUA",Marauke:"PAPUA",Sorong:"PAPUA BARAT",Manokwari:"PAPUA BARAT",Denpasar:"BALI",Mataram:"NUSATENGGARA BARAT",Bima:"NUSATENGGARA BARAT",Kupang:"NUSA TENGGARA TIMUR",Waikabubak:"NUSA TENGGARA TIMUR",Ruteng:"NUSA TENGGARA TIMUR",Ende:"NUSA TENGGARA TIMUR",Atambua:"NUSA TENGGARA TIMUR",Larantuka:"NUSA TENGGARA TIMUR"},St={"Region 1":"#ef4444","Region 2":"#3b82f6","Region 3":"#10b981","Region 4":"#f59e0b","Region 5":"#8b5cf6","Region 6":"#ec4899","Region 7":"#14b8a6","Region 8":"#f97316","Region 9":"#6366f1","Region 10":"#eab308"},Ne=j=>St[j]||"#94a3b8",Pe=it.memo(function({machines:x,engineers:p=[],onEngineerClick:C,isFullscreen:h=!1}){const[k,T]=l.useState(null),[oe,se]=l.useState(null),[K,b]=l.useState(!0),{theme:ae,isDark:d}=Je(),V=l.useMemo(()=>{const n={};return(p||[]).forEach(o=>{const u=o.area_group||"Unknown",N=o.region||"Unknown",w=ze[u]||u;n[w]||(n[w]={areaGroup:w,cities:new Set,region:N,engineerCount:0,machineCount:0,engineers:[],latitude:0,longitude:0,validCoords:0}),n[w].cities.add(u),n[w].engineerCount++,n[w].engineers.push(o),o.latitude&&o.longitude&&(n[w].latitude+=parseFloat(o.latitude),n[w].longitude+=parseFloat(o.longitude),n[w].validCoords++)}),Object.keys(n).forEach(o=>{n[o].validCoords>0&&(n[o].latitude/=n[o].validCoords,n[o].longitude/=n[o].validCoords)}),(x||[]).forEach(o=>{const u=o.area_group||"Unknown",N=ze[u]||u;n[N]||(n[N]={areaGroup:N,cities:new Set,region:"Unknown",engineerCount:0,machineCount:0,engineers:[],latitude:0,longitude:0,validCoords:0}),n[N].machineCount++}),n},[p,x]),E=l.useRef(null);if(l.useEffect(()=>(k&&Object.keys(V).length>0&&(E.current&&clearTimeout(E.current),E.current=setTimeout(()=>{requestAnimationFrame(()=>{const n=vt.latLngBounds();Object.values(V).forEach(o=>{o.latitude&&o.longitude&&o.validCoords>0&&n.extend([o.latitude,o.longitude])}),n.isValid()&&k.fitBounds(n,{padding:[50,50],animate:!1})})},150)),()=>{E.current&&clearTimeout(E.current)}),[k,V]),(!p||p.length===0)&&(!x||x.length===0))return e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("div",{className:"text-slate-400",children:"No data available"})});const y=Object.values(V).filter(n=>n.validCoords>0||n.machineCount>0).sort((n,o)=>o.engineerCount+o.machineCount-(n.engineerCount+n.machineCount)),ce=l.useMemo(()=>{const n={};return y.forEach(o=>{const u=o.region||"Unknown";n[u]||(n[u]={region:u,provinceCount:0,totalMachines:0,totalEngineers:0,provinces:[]}),n[u].provinceCount++,n[u].totalMachines+=o.machineCount,n[u].totalEngineers+=o.engineerCount,n[u].provinces.push({name:o.areaGroup,machines:o.machineCount,engineers:o.engineerCount})}),Object.keys(n).forEach(o=>{n[o].provinces.sort((u,N)=>N.machines-u.machines)}),n},[y]),Z=l.useMemo(()=>y.sort((n,o)=>o.machineCount-n.machineCount).slice(0,5).map(n=>({name:n.areaGroup,machines:n.machineCount,engineers:n.engineerCount,region:n.region})),[y]),H=l.useMemo(()=>Math.max(...y.map(n=>n.engineerCount),1),[y]),de=l.useCallback(n=>{const o=n.properties.Propinsi||n.properties.name||"",u=y.find(z=>o.toUpperCase()===z.areaGroup.toUpperCase());let N,$=1.5,w=.4;if(u){N=Ne(u.region);const z=u.engineerCount/H;$=1.5+z*4.5,w=.4+z*.5}else N="#e5e7eb",$=1,w=.15;return{fillColor:N,fillOpacity:w,color:"#ffffff",weight:$,opacity:.95}},[y,H]),xe=l.useCallback((n,o)=>{const u=n.properties.Propinsi||n.properties.name||"",N=y.find($=>u.toUpperCase()===$.areaGroup.toUpperCase());if(N){const $=Ne(N.region),w=N.engineerCount/H,z=1.5+w*4.5,he=.4+w*.5,ne=Array.from(N.cities||[]).join(", "),Y=d?"#0f172a":"#ffffff",P=d?"#ffffff":"#0f172a",R=$,M=d?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.2)";o.bindTooltip(`<div style="background: ${Y}; padding: 12px 16px; border-radius: 8px; box-shadow: 0 8px 16px ${M}; border: 2px solid ${R}; line-height: 1.8; overflow: hidden;">
            <div style="font-weight: 700; font-size: 14px; margin-bottom: 8px; color: ${P};">üìç ${N.areaGroup}</div>
            <div style="color: ${P}; margin-bottom: 6px;">üèôÔ∏è ${ne}</div>
            <div style="color: ${P}; margin-bottom: 6px;">üñ•Ô∏è <span style="color: ${P}; font-weight: 700;">${N.machineCount||0}</span> mesin</div>
            <div style="color: ${P}; margin-bottom: 6px;">üë∑ <span style="color: ${P}; font-weight: 700;">${N.engineerCount}</span> engineers</div>
            <div style="color: ${P}; font-size: 12px; opacity: 0.9;">üó∫Ô∏è ${N.region}</div>
          </div>`,{sticky:!0,className:"custom-map-tooltip",direction:"auto",permanent:!1});let W=null;o.on({mouseover:q=>{W&&clearTimeout(W),W=setTimeout(()=>{requestAnimationFrame(()=>{q.target.setStyle({fillOpacity:.95,weight:z+2})})},16)},mouseout:q=>{W&&clearTimeout(W),requestAnimationFrame(()=>{q.target.setStyle({fillOpacity:he,weight:z})})}})}},[y,H,d]);return e.jsxs("div",{className:"map-container relative",style:{height:"100%",width:"100%",borderRadius:h?"0":"16px",overflow:"hidden",boxShadow:h?"none":"0 20px 25px -5px rgba(0, 0, 0, 0.3)",border:h?"none":"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsxs(ot,{center:[-2.5489,118.0149],zoom:5,style:{height:"100%",width:"100%"},whenCreated:T,zoomControl:!0,children:[e.jsx(ct,{url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",attribution:'¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.jsx(dt,{data:wt,style:de,onEachFeature:xe},`geojson-${ae}`)]}),K?e.jsxs("div",{className:`absolute top-4 right-4 z-[100] ${d?"bg-slate-900/95":"bg-white/95"} backdrop-blur-sm rounded-lg border ${d?"border-slate-700":"border-gray-300"} shadow-xl p-4 max-w-xs`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:`font-bold text-sm ${d?"text-white":"text-gray-900"}`,children:"üó∫Ô∏è Legend"}),e.jsx("button",{onClick:()=>b(!1),className:`p-1 rounded hover:${d?"bg-slate-800":"bg-gray-100"} transition-colors ${d?"text-slate-400 hover:text-white":"text-gray-500 hover:text-gray-700"}`,title:"Sembunyikan Legend",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:`text-xs font-semibold mb-2 ${d?"text-slate-300":"text-gray-700"}`,children:"Region"}),e.jsx("div",{className:"space-y-1.5",children:["Region 1","Region 2","Region 3"].map(n=>{const o=Ne(n),u=ce[n];return e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"w-4 h-4 rounded border-2 border-white shadow-sm",style:{backgroundColor:o}}),e.jsx("span",{className:`flex-1 ${d?"text-slate-200":"text-gray-800"}`,children:n}),u&&e.jsxs("span",{className:`font-semibold ${d?"text-slate-400":"text-gray-600"}`,children:[u.provinceCount," prov"]})]},n)})})]}),Z.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:`text-xs font-semibold mb-2 ${d?"text-slate-300":"text-gray-700"}`,children:"üèÜ Top 5 Provinsi (Mesin)"}),e.jsx("div",{className:"space-y-1.5 max-h-48 overflow-y-auto",children:Z.map((n,o)=>{const u=Ne(n.region);return e.jsxs("div",{className:`flex items-center gap-2 text-xs p-1.5 rounded ${d?"bg-slate-800/50":"bg-gray-50"} hover:${d?"bg-slate-800":"bg-gray-100"} transition-colors`,children:[e.jsx("span",{className:`font-bold w-5 text-center ${d?"text-slate-400":"text-gray-500"}`,children:o+1}),e.jsx("div",{className:"w-3 h-3 rounded border border-white/50",style:{backgroundColor:u}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`font-medium truncate ${d?"text-slate-200":"text-gray-800"}`,children:n.name}),e.jsxs("div",{className:`text-xs ${d?"text-slate-400":"text-gray-600"}`,children:[n.machines," mesin"]})]})]},o)})})]})]}):e.jsx("button",{onClick:()=>b(!0),className:`absolute top-4 right-4 z-[100] ${d?"bg-slate-900/95 hover:bg-slate-800":"bg-white/95 hover:bg-gray-50"} backdrop-blur-sm rounded-lg border ${d?"border-slate-700":"border-gray-300"} shadow-xl p-2 transition-colors`,title:"Tampilkan Legend",children:e.jsx("svg",{className:`w-5 h-5 ${d?"text-slate-300":"text-gray-700"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})},(j,x)=>{var p,C,h,k;return!(j.isFullscreen!==x.isFullscreen||j.onEngineerClick!==x.onEngineerClick||j.machines!==x.machines&&((p=j.machines)==null?void 0:p.length)!==((C=x.machines)==null?void 0:C.length)||j.engineers!==x.engineers&&((h=j.engineers)==null?void 0:h.length)!==((k=x.engineers)==null?void 0:k.length))}),Ke=(j,x="area_group",p)=>{if(!p){const{normalizeAreaGroup:h}=require("./textUtils");p=h}const C={};return j.forEach(h=>{const k=h[x]||"Unknown",T=p(k);C[T]=(C[T]||0)+1}),C};function Mt(j,x=50,p="sample"){if(!Array.isArray(j)||j.length<=x)return j;if(p==="aggregate"){const C=Math.ceil(j.length/x),h=[];for(let k=0;k<j.length;k+=C){const T=j.slice(k,k+C),oe=Object.keys(T[0]).filter(K=>typeof T[0][K]=="number"),se={...T[0]};oe.forEach(K=>{const b=T.reduce((ae,d)=>ae+(d[K]||0),0);se[K]=Math.round(b/T.length)}),h.push(se)}return h}else{const C=j.length/x,h=[];for(let k=0;k<x;k++){const T=Math.floor(k*C);h.push(j[T])}return h}}const Tt=l.lazy(()=>lt(()=>import("./FullscreenChartModal-BlV1ZmyP.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])));function Rt(){var Ie,Ue,We,$e,Be;const j=xt(),{isDark:x}=Je(),{rows:p,loading:C}=mt(),{rows:h,loading:k}=ut(),{rows:T,loading:oe}=gt(),{rows:se,loading:K}=pt(),[b,ae]=l.useState("REGION"),[d,V]=l.useState(""),[E,y]=l.useState(null),[ce,Z]=l.useState(!1),[H,de]=l.useState(!1),[xe,n]=l.useState(!1),[o,u]=l.useState([]),[N,$]=l.useState(!0);l.useEffect(()=>{const s=setTimeout(async()=>{try{$(!0),console.log("[DEBUG] Fetching monthly machine data...");const a=await fetch("/api/monthly-machines");if(console.log("[DEBUG] Response status:",a.status),a.ok){const i=await a.json();console.log("[DEBUG] Received data:",i),requestAnimationFrame(()=>{u(i.rows||[])})}else console.warn("[DEBUG] Monthly machine data not available"),u([])}catch(a){console.error("[DEBUG] Error fetching monthly machine data:",a),u([])}finally{requestAnimationFrame(()=>{$(!1)})}},100);return()=>clearTimeout(s)},[]);const w=t=>{let s;if(t.instal_date){const a=t.instal_date;if(a.includes("-")){const i=a.split("-"),c=i[i.length-1];s=c.length===2?"20"+c:c}}else t.year&&(s=t.year.toString());return s||null},z=(t,s)=>{const a=w(t);if(!a)return null;const i=parseInt(a);return isNaN(i)?null:s-i},he=(t,s,a)=>{for(const i of s)if(t<=i.max)return i.label;return a},ne=(t,s,a="Unknown")=>{const i={};return t.forEach(c=>{const r=c[s]||a;i[r]=(i[r]||0)+1}),i},Y=(t,s="name",a="value")=>Object.entries(t).map(([i,c])=>({[s]:i,[a]:c})),P=l.useMemo(()=>{let t=[];if(b==="REGION")t=["Region 1","Region 2","Region 3"];else if(b==="VENDOR")t=p.map(i=>i.vendor).filter(Boolean);else if(b==="AREA GROUP"){const a=p.map(r=>r.area_group).filter(Boolean),i=h.map(r=>r.area_group).filter(Boolean);t=[...a,...i];const c=new Map;t.forEach(r=>{const S=yt(r);c.has(S)||c.set(S,At(S))}),t=Array.from(c.values())}return[...new Set(t)].filter(Boolean).sort((a,i)=>{if(b==="REGION"){const c=["Region 1","Region 2","Region 3"],r=c.indexOf(a),S=c.indexOf(i);if(r!==-1&&S!==-1)return r-S;if(r!==-1)return-1;if(S!==-1)return 1}return a.localeCompare(i)})},[p,h,b]),R=l.useMemo(()=>{if(!d)return p;const t=b==="REGION"?"region":b==="VENDOR"?"vendor":"area_group";return b==="AREA GROUP"?p.filter(s=>{var r;const a=(r=s[t])==null?void 0:r.toLowerCase().trim().replace(/\s+/g," "),i=d.toLowerCase().trim();return a.replace(/\s+\d+$/,"")===i}):p.filter(s=>s[t]===d)},[p,b,d]),M=l.useMemo(()=>d?b==="REGION"?h.filter(t=>{const s=p.find(a=>a.area_group===t.area_group||a.vendor===t.customer);return(s==null?void 0:s.region)===d||t.region===d}):b==="VENDOR"?h.filter(t=>t.customer===d):b==="AREA GROUP"?h.filter(t=>{var c;const s=(c=t.area_group)==null?void 0:c.toLowerCase().trim().replace(/\s+/g," "),a=d.toLowerCase().trim();return s.replace(/\s+\d+$/,"")===a}):h:h,[h,p,b,d]),W=l.useMemo(()=>ne(h,"provinsi","Unknown"),[h]),q=l.useMemo(()=>ne(p,"region","Unknown"),[p]),_e=l.useMemo(()=>Ke(h,"area_group",Oe),[h]),Fe=l.useMemo(()=>ne(h,"customer","Unknown"),[h]),Ve=l.useMemo(()=>Ke(p,"area_group",Oe),[p]);l.useMemo(()=>d||`All ${b}s`,[d,b]);const B=l.useMemo(()=>M.length,[M]),U=l.useMemo(()=>R.length,[R]),He=l.useMemo(()=>h.length,[h]),ee=l.useMemo(()=>p.length,[p]),Ye=jt(M,h),{onWarranty:X,outOfWarranty:re,warrantyRemaining:I}=Ye,f=B>0?X/B*100:0,Se=l.useMemo(()=>!T||T.length===0?[]:T.filter(t=>(t.part_number||t["part number"]||"").toLowerCase()!=="region"),[T]);bt(Se,Se,se||[]);const m=l.useMemo(()=>{if(!M||M.length===0)return null;const t=(r,S=2)=>{if(!r)return{days:0,expired:!0,status:"expired"};const ye=parseInt(r)||new Date().getFullYear(),me=new Date,ue=new Date(ye+S,11,31)-me,Q=Math.ceil(ue/(1e3*60*60*24));if(Q<0)return{days:0,expired:!0,status:"expired"};let te="good";return Q<90?te="critical":Q<180&&(te="warning"),{days:Q,expired:!1,status:te,months:Math.floor(Q/30)}},s=M.filter(r=>r.machine_status==="On Warranty"||r.machine_status==="In Warranty").map(r=>({...r,warrantyInfo:t(r.year,2)})).filter(r=>!r.warrantyInfo.expired),a=s.filter(r=>r.warrantyInfo.status==="critical").sort((r,S)=>r.warrantyInfo.days-S.warrantyInfo.days).slice(0,10),i=s.reduce((r,S)=>(r[S.warrantyInfo.status]=(r[S.warrantyInfo.status]||0)+1,r),{critical:0,warning:0,good:0}),c={"0-30 hari":s.filter(r=>r.warrantyInfo.days<=30).length,"31-90 hari":s.filter(r=>r.warrantyInfo.days>30&&r.warrantyInfo.days<=90).length,"91-180 hari":s.filter(r=>r.warrantyInfo.days>90&&r.warrantyInfo.days<=180).length,"181-365 hari":s.filter(r=>r.warrantyInfo.days>180&&r.warrantyInfo.days<=365).length,"> 365 hari":s.filter(r=>r.warrantyInfo.days>365).length};return{totalOnWarranty:s.length,expiringSoonMachines:a,distribution:i,timeRanges:c,avgRemaining:I}},[M,I]),g=l.useMemo(()=>U>0?B/U:0,[B,U]),qe=l.useMemo(()=>g<60?"Good":g<70?"Moderate":"High",[g]),Me=l.useMemo(()=>g<60?"text-green-400":g<70?"text-yellow-400":"text-red-400",[g]),Xe=l.useMemo(()=>g<60?"üòä":g<70?"üòê":"üò∞",[g]),Te=l.useMemo(()=>{if(g<=0)return"0%";const t=60,s=70;if(g<=t)return"100%";if(g<=s){const a=100-(g-t)/(s-t)*15;return`${Math.max(85,Math.round(a))}%`}else{const a=t/g*100;return`${Math.max(0,Math.min(85,Math.round(a)))}%`}},[g]),Re=l.useMemo(()=>`${Math.min(100,Math.round(g/70*100))}%`,[g]),Qe=l.useMemo(()=>{if(g<=0)return"0%";const t=60,s=70;if(g<=t)return"100%";if(g<=s){const a=100-(g-t)/(s-t)*15;return`${Math.max(85,a)}%`}else{const a=t/g*100;return`${Math.max(0,Math.min(85,a))}%`}},[g]),Ze=l.useMemo(()=>`${Math.min(100,g/70*100)}%`,[g]),et=l.useMemo(()=>{const t=[{max:2,label:"0-2 years"},{max:5,label:"3-5 years"},{max:10,label:"6-10 years"}],s="10+ years",a={};return t.forEach(i=>a[i.label]=0),a[s]=0,R.forEach(i=>{const c=i.experience||0,r=he(c,t,s);a[r]++}),Y(a,"range","count")},[R]),tt=l.useMemo(()=>{const t={};return R.forEach(s=>{(s.skills||[]).forEach(i=>{t[i]=(t[i]||0)+1})}),Object.entries(t).map(([s,a])=>({skill:s,count:a})).sort((s,a)=>a.count-s.count).slice(0,10)},[R]),st=l.useMemo(()=>{const t={Completed:0,"In Progress":0,"Not Started":0};return R.forEach(s=>{const a=s.training_status||"Not Started";t.hasOwnProperty(a)&&t[a]++}),Y(t,"name","value")},[R]),at=l.useMemo(()=>{const t={"In Warranty":0,"Out Of Warranty":0};return M.forEach(s=>{const a=s.machine_status||"Unknown";a.includes("Warranty")&&(a==="Out Of Warranty"?t["Out Of Warranty"]++:t["In Warranty"]++)}),Y(t,"name","value")},[M]),v=l.useMemo(()=>{if(!o||o.length===0)return[];const t=o.map(s=>{const a=s.month||s.bulan||"",i=s.year||new Date().getFullYear(),c=s.total_activation||s.total_aktifasi||s.jumlah||s.count||0;return{month:`${a} ${i}`,count:parseInt(c)}});return Mt(t,36,"sample")},[o]),Le=l.useCallback(t=>{const s=parseFloat(t);return isNaN(s)?"0%":Math.abs(s)>=1e3?`${Math.round(s).toLocaleString("en-US")}%`:Math.abs(s)>=100?`${Math.round(s)}%`:`${s.toFixed(1)}%`},[]),L=l.useMemo(()=>{var te,De,Ge;if(!v||v.length===0)return{total:0,average:0,highest:{month:"-",count:0},lowest:{month:"-",count:0},growthRate:0,growthRateFormatted:"0%",recentTrend:"stable"};const t=((te=v[v.length-1])==null?void 0:te.count)||0,s=Math.round(v.reduce((D,G)=>D+G.count,0)/v.length),a=v.reduce((D,G)=>G.count>D.count?G:D,v[0]),i=v.reduce((D,G)=>G.count<D.count?G:D,v[0]),c=((De=v[0])==null?void 0:De.count)||1,S=((((Ge=v[v.length-1])==null?void 0:Ge.count)||0)-c)/c*100,ye=Le(S),me=v.slice(-6),Ae=me.reduce((D,G)=>D+G.count,0)/me.length,ue=v.slice(-12,-6).reduce((D,G)=>D+G.count,0)/6,Q=Ae>ue*1.05?"growing":Ae<ue*.95?"declining":"stable";return{total:t,average:s,highest:a,lowest:i,growthRate:S,growthRateFormatted:ye,recentTrend:Q}},[v,Le]),Ce=l.useMemo(()=>{const t=new Date().getFullYear(),s=[{max:2,label:"0-2 years"},{max:5,label:"3-5 years"},{max:10,label:"6-10 years"},{max:15,label:"11-15 years"}],a="15+ years",i={};return s.forEach(c=>i[c.label]=0),i[a]=0,M.forEach(c=>{const r=z(c,t);if(r!==null&&r>=0){const S=he(r,s,a);i[S]++}}),Y(i,"range","count")},[M]),Ee=l.useMemo(()=>{const t={},s=new Date().getFullYear();return M.forEach(i=>{const c=w(i);if(c){const r=parseInt(c);r>=s-20&&r<=s&&(t[c]=(t[c]||0)+1)}}),Y(t,"year","count").sort((i,c)=>i.year-c.year)},[M]),ve=l.useCallback(t=>{j("/engineers",{state:{selectedEngineer:t}})},[j]),nt=l.useMemo(()=>{const t=Object.entries(q).map(([s,a])=>({name:s,value:a,ratio:W!=null&&W[s]?Math.round(W[s]/a):0})).sort((s,a)=>a.value-s.value).slice(0,3);return t.length===0?e.jsx(J,{width:"100%",height:50,children:e.jsxs(ge,{data:[{name:"Filter",value:U},{name:"Total",value:ee}],margin:{top:5,right:5,left:0,bottom:5},children:[e.jsx(_,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #10b981",borderRadius:"8px",padding:"6px 10px"},labelStyle:{color:"#e2e8f0",fontSize:"11px",fontWeight:"bold"},itemStyle:{color:"#6ee7b7",fontSize:"11px"},formatter:s=>[s.toLocaleString(),"Jumlah"]}),e.jsx(pe,{dataKey:"value",fill:"#10b981",radius:[4,4,0,0]}),e.jsx(F,{dataKey:"name",tick:{fill:"#cbd5e1",fontSize:10},stroke:"#64748b",height:20})]})}):e.jsx(J,{width:"100%",height:50,children:e.jsxs(ge,{data:t,margin:{top:5,right:5,left:0,bottom:20},children:[e.jsx(_,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #10b981",borderRadius:"8px",padding:"6px 10px"},labelStyle:{color:"#e2e8f0",fontSize:"11px",fontWeight:"bold"},itemStyle:{color:"#6ee7b7",fontSize:"11px"},formatter:(s,a)=>a==="value"?[s.toLocaleString(),"Engineer"]:[s,"Rasio"]}),e.jsx(pe,{dataKey:"value",fill:"#10b981",radius:[4,4,0,0],children:t.map((s,a)=>{const i=parseFloat(s.ratio);let c="#10b981";return i>70?c="#ef4444":i>60&&(c="#f59e0b"),e.jsx(ht,{fill:c},`cell-${a}`)})}),e.jsx(F,{dataKey:"name",tick:{fill:"#cbd5e1",fontSize:9},stroke:"#64748b",height:30,angle:-45,textAnchor:"end"})]})})},[q,W,U,ee]);return C||k||oe||K?e.jsx("div",{className:"flex items-center justify-center h-screen bg-slate-900",children:e.jsx(rt,{type:"spinner",message:"Memuat data dashboard...",size:"lg"})}):e.jsxs(kt,{title:"ROC Dashboard",subtitle:"Engineering & Machine Management Overview",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:O(le("blue",!0),"min-h-[200px]"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:A.kpiTitle,children:"Total Mesin"}),e.jsx("h3",{className:A.kpiValue,children:B.toLocaleString()}),e.jsx("p",{className:A.kpiSubtitle,children:d||`Semua ${b}`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl",children:"üñ•Ô∏è"}),e.jsx("button",{onClick:()=>y("total-machines"),className:"text-slate-400 hover:text-blue-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-blue-600/20 hover:bg-blue-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"w-full h-3 bg-slate-700/50 rounded-full overflow-hidden relative",children:[e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-green-400 transition-all duration-500",style:{width:`${f}%`}}),e.jsx("div",{className:"absolute top-0 right-0 h-full bg-gradient-to-r from-red-500/80 to-red-400/80 transition-all duration-500",style:{width:`${100-f}%`}})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-2.5 hover:bg-green-500/20 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-green-400 text-lg",children:"‚úÖ"}),e.jsx("span",{className:"text-xs text-green-300 font-semibold",children:"On Warranty"})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-xl font-bold text-green-400",children:X.toLocaleString()}),e.jsxs("span",{className:"text-xs text-green-300/70",children:["(",f.toFixed(1),"%)"]})]})]}),e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-2.5 hover:bg-red-500/20 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-red-400 text-lg",children:"‚ö†Ô∏è"}),e.jsx("span",{className:"text-xs text-red-300 font-semibold",children:"Expired"})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-xl font-bold text-red-400",children:re.toLocaleString()}),e.jsxs("span",{className:"text-xs text-red-300/70",children:["(",(100-f).toFixed(1),"%)"]})]})]})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400",children:[e.jsx("span",{children:"Coverage Rate"}),e.jsxs("span",{className:O("font-semibold",f>=50?"text-green-400":f>=30?"text-yellow-400":"text-red-400"),children:[f.toFixed(1),"%"]})]}),I&&I.avgMonths>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-400 mt-1",children:[e.jsx("span",{children:"Avg. Remaining"}),e.jsxs("span",{className:"text-blue-400 font-semibold",children:[I.avgMonths," bulan"]})]})]})]})]}),e.jsxs("div",{className:O(le("green",!0),"min-h-[200px]"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:A.kpiTitle,children:"Total Engineer"}),e.jsx("h3",{className:A.kpiValue,children:U.toLocaleString()}),e.jsx("p",{className:A.kpiSubtitle,children:d||`Semua ${b}`})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl",children:"üë®‚Äçüíº"}),e.jsx("button",{onClick:()=>y("total-engineers"),className:"text-slate-400 hover:text-green-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-green-600/20 hover:bg-green-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-slate-400",children:["Filter: ",U.toLocaleString()]}),e.jsxs("span",{className:"text-slate-500",children:["Total: ",ee.toLocaleString()]}),e.jsxs("span",{className:"text-green-400 font-semibold",children:[ee>0?(U/ee*100).toFixed(1):0,"%"]})]}),U>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs px-1",children:[e.jsx("span",{className:"text-slate-400",children:"Rasio:"}),e.jsxs("span",{className:`font-semibold ${B/U<60?"text-green-400":B/U<70?"text-yellow-400":"text-red-400"}`,children:[Math.round(B/U)," mesin/engineer"]})]}),nt]})]}),e.jsxs("div",{className:O(le("purple",!0),"min-h-[200px]"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:A.kpiTitle,children:"Rasio Mesin/Engineer"}),e.jsx("h3",{className:A.kpiValue,children:Math.round(g)}),e.jsx("p",{className:A.kpiSubtitle,children:"Mesin per engineer"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl",children:"‚öôÔ∏è"}),e.jsx("button",{onClick:()=>y("machine-ratio"),className:"text-slate-400 hover:text-purple-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-purple-600/20 hover:bg-purple-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(J,{width:"100%",height:95,children:e.jsxs(fe,{data:[{name:"Opt",value:60},{name:"Skrg",value:g},{name:"Max",value:70}],margin:{top:10,right:10,left:0,bottom:10},children:[e.jsx(_,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #8b5cf6",borderRadius:"8px",padding:"6px 10px"},labelStyle:{color:"#e2e8f0",fontSize:"11px",fontWeight:"bold"},itemStyle:{color:"#c4b5fd",fontSize:"11px"},formatter:t=>[`${Math.round(t)}`,"Ratio"]}),e.jsx(be,{type:"monotone",dataKey:"value",stroke:"#8b5cf6",strokeWidth:2.5,dot:{fill:"#8b5cf6",r:4,strokeWidth:2,stroke:"#1e293b"}}),e.jsx(F,{dataKey:"name",tick:{fill:"#cbd5e1",fontSize:10},stroke:"#64748b",height:25}),e.jsx(ie,{tick:{fill:"#cbd5e1",fontSize:10},stroke:"#64748b",domain:[0,100],width:35})]})})})]}),e.jsxs("div",{className:O(le("orange",!0),"min-h-[200px]"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:A.kpiTitle,children:"Efisiensi"}),e.jsx("h3",{className:O("text-3xl font-bold",Me),children:qe}),e.jsx("p",{className:A.kpiSubtitle,children:"Status beban kerja"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-3xl",children:Xe}),e.jsx("button",{onClick:()=>y("efficiency-status"),className:"text-slate-400 hover:text-orange-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-orange-600/20 hover:bg-orange-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})]}),e.jsx("div",{className:"mt-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-200 font-medium",children:"Efisiensi"}),e.jsx("span",{className:`font-bold ${Me}`,children:Te})]}),e.jsx("div",{className:"w-full h-3.5 bg-slate-700/50 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-500 ${g<60?"bg-gradient-to-r from-green-400 to-green-300":g<70?"bg-gradient-to-r from-yellow-400 to-yellow-300":"bg-gradient-to-r from-red-400 to-red-300"}`,style:{width:Qe}})}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-slate-200 font-medium",children:"Beban"}),e.jsx("span",{className:"text-slate-200 font-bold",children:Re})]}),e.jsx("div",{className:"w-full h-3.5 bg-slate-700/50 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-slate-400 to-slate-500 transition-all duration-500",style:{width:Ze}})})]})})]})]}),E==="map"&&e.jsxs("div",{className:"fixed inset-0 z-[9999] bg-slate-900 flex flex-col",style:{zIndex:9999,position:"fixed",top:0,left:0,right:0,bottom:0},children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-slate-700 flex-shrink-0",style:{height:"auto"},children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"Sebaran Service Point HCS-IDN"}),e.jsx("button",{onClick:()=>y(null),className:"text-slate-400 hover:text-white transition-colors p-2 rounded-lg hover:bg-slate-800",children:e.jsx(we,{size:24})})]}),e.jsx("div",{className:"flex-1 overflow-hidden",style:{minHeight:0,height:"calc(100vh - 80px)",width:"100%"},children:e.jsx("div",{style:{height:"100%",width:"100%",position:"relative"},children:e.jsx("div",{style:{height:"100%",width:"100%",borderRadius:0,overflow:"hidden",boxShadow:"none",border:"none"},children:e.jsx(Pe,{machines:M,engineers:R,onEngineerClick:ve,isFullscreen:!0})})})})]}),E!=="map"&&e.jsxs("div",{className:"bg-[var(--card-bg)] p-4 rounded-lg relative",style:{height:"600px",display:"flex",flexDirection:"column"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-100",children:"Sebaran Service Point HCS-IDN"}),e.jsx("button",{onClick:()=>y("map"),className:"text-slate-400 hover:text-blue-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-blue-600/20 hover:bg-blue-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-slate-700/50",children:[e.jsx("div",{className:"flex gap-2",children:[{name:"REGION",label:"Region"},{name:"VENDOR",label:"Vendor"},{name:"AREA GROUP",label:"Area"}].map(t=>e.jsx("button",{onClick:()=>ae(t.name),className:`text-sm px-4 py-2 rounded transition-all ${b===t.name?"bg-blue-600/80 text-white font-semibold":"bg-slate-800/50 text-slate-300 hover:bg-slate-700/60"}`,title:t.label,children:t.label},t.name))}),e.jsxs("div",{className:"flex items-center gap-2 ml-auto",children:[e.jsxs("select",{className:"text-sm bg-slate-800/70 text-slate-200 px-3 py-2 rounded border border-slate-600/50 focus:outline-none focus:border-blue-400/70 cursor-pointer",value:d,onChange:t=>V(t.target.value),children:[e.jsxs("option",{value:"",children:["All ",b,"s"]}),P.map(t=>e.jsx("option",{value:t,children:t},t))]}),d&&e.jsx("button",{onClick:()=>V(""),className:"text-slate-400 hover:text-red-400 text-base font-bold px-2 py-1",title:"Clear",children:"‚úï"})]})]}),(()=>{const t=ce||H||xe||E&&E!=="map";return e.jsx("div",{style:{flex:1,height:"100%",minHeight:"0",position:"relative",zIndex:t?1:"auto",pointerEvents:t?"none":"auto"},className:t?"map-container-modal-open":"",children:e.jsx(Pe,{machines:M,engineers:R,onEngineerClick:ve})})})()]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{className:"bg-[var(--card-bg)] p-4 rounded-lg relative min-h-[400px] max-h-[500px] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-100",children:"Training Skill Progress"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-slate-400",children:[R.length," engineers"]}),e.jsx("button",{onClick:()=>y("training-skills"),className:"text-slate-400 hover:text-blue-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-blue-600/20 hover:bg-blue-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]})]}),!E&&e.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2 scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-slate-800",children:R.length>0?R.map((t,s)=>e.jsx(Nt,{engineer:t},s)):e.jsx("div",{className:"flex items-center justify-center h-full text-slate-500",children:"No engineers data available"})})]}),e.jsxs("div",{className:O(le("green",!0),"min-h-[400px] max-h-[500px] flex flex-col overflow-hidden"),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4 flex-shrink-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:A.kpiTitle,children:"Coverage Garansi"}),e.jsxs("h3",{className:A.kpiValue,children:[f.toFixed(1),"%"]}),e.jsx("p",{className:A.kpiSubtitle,children:d||`Semua ${b}`})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>{console.log("Opening Warranty Insight Modal..."),console.log("warrantyInsights:",m),de(!0)},className:"text-slate-400 hover:text-green-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-green-600/20 hover:bg-green-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})})]}),e.jsxs("div",{className:"mt-4 flex-shrink-0",children:[e.jsxs("div",{className:"w-full h-4 bg-slate-700 rounded-full overflow-hidden relative",children:[e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-green-400 transition-all duration-500",style:{width:`${f}%`}}),e.jsx("div",{className:"absolute top-0 right-0 h-full bg-gradient-to-r from-red-500 to-red-400 transition-all duration-500",style:{width:`${100-f}%`}})]}),e.jsxs("div",{className:"flex justify-between mt-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-400"}),e.jsxs("span",{className:"text-green-400 font-semibold",children:[X.toLocaleString()," aktif"]}),e.jsxs("span",{className:"text-slate-500",children:["(",f.toFixed(1),"%)"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-400"}),e.jsxs("span",{className:"text-red-400 font-semibold",children:[re.toLocaleString()," expired"]}),e.jsxs("span",{className:"text-slate-500",children:["(",(100-f).toFixed(1),"%)"]})]})]})]}),I&&I.avgDays>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-700/50 flex-1 flex flex-col min-h-0 overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3 flex-shrink-0",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 border border-slate-700/50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-lg",children:"‚è±Ô∏è"}),e.jsx("span",{className:"text-xs text-slate-400",children:"Rata-rata Sisa"})]}),e.jsx("div",{className:"text-lg font-bold text-green-400",children:I.avgMonths>0?`${I.avgMonths} bulan`:`${I.avgDays} hari`})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3 border border-slate-700/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-xs text-slate-400",children:"Total Aktif"})}),e.jsx("div",{className:"text-lg font-bold text-green-400",children:X.toLocaleString()})]})]}),m&&m.expiringSoonMachines&&m.expiringSoonMachines.length>0&&e.jsxs("div",{className:"mb-2 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"text-xs text-slate-400 font-semibold flex items-center gap-1",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," Mesin yang Expiring Soon"]}),m.expiringSoonMachines.length>3&&e.jsx("button",{onClick:()=>n(!0),className:"text-xs text-green-400 hover:text-green-300 transition-colors font-semibold",children:"Lihat Detail ‚Üí"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700/50",children:[e.jsx("th",{className:"text-left py-1 px-2 text-slate-400 font-semibold",children:"#"}),e.jsx("th",{className:"text-left py-1 px-2 text-slate-400 font-semibold",children:"WSID"}),e.jsx("th",{className:"text-left py-1 px-2 text-slate-400 font-semibold",children:"Area"}),e.jsx("th",{className:"text-right py-1 px-2 text-slate-400 font-semibold",children:"Sisa"})]})}),e.jsx("tbody",{children:m.expiringSoonMachines.slice(0,3).map((t,s)=>e.jsxs("tr",{className:"border-b border-slate-700/30 hover:bg-slate-800/50 transition-colors last:border-b-0",children:[e.jsx("td",{className:"py-1 px-2 text-slate-300 font-mono",children:s+1}),e.jsx("td",{className:"py-1 px-2",children:e.jsx("div",{className:"text-slate-200 font-mono truncate max-w-[120px]",title:t.wsid||"Unknown",children:t.wsid||"Unknown"})}),e.jsx("td",{className:"py-1 px-2",children:e.jsx("div",{className:"text-slate-400 truncate max-w-[100px]",title:t.area_group||"Unknown",children:t.area_group||"Unknown"})}),e.jsx("td",{className:"py-1 px-2 text-right",children:e.jsxs("div",{className:`font-bold ${t.warrantyInfo.days<=30?"text-red-400":t.warrantyInfo.days<=60?"text-orange-400":"text-yellow-400"}`,children:[t.warrantyInfo.days," hari"]})})]},s))})]})})]}),e.jsx("div",{className:"mt-auto pt-3 border-t border-slate-700/50 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"text-slate-400",children:["Total Mesin: ",e.jsx("span",{className:"text-slate-200 font-semibold",children:B.toLocaleString()})]}),e.jsxs("div",{className:"text-slate-400",children:["Coverage: ",e.jsxs("span",{className:"text-green-400 font-semibold",children:[f.toFixed(1),"%"]})]})]})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4",children:[e.jsxs("div",{className:O(ke("blue",!0),"min-h-[340px]"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:A.heading4,children:"Aktivasi Mesin Per Bulan"}),e.jsx("p",{className:A.mutedSmall,children:"Trend aktivasi mesin bulanan"})]}),e.jsx("button",{onClick:()=>Z(!0),className:"text-slate-400 hover:text-blue-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-blue-600/20 hover:bg-blue-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]}),N?e.jsx("div",{className:"flex items-center justify-center",style:{height:"220px"},children:e.jsx("div",{className:"text-slate-500",children:"Loading data aktivasi..."})}):v.length===0?e.jsx("div",{className:"flex items-center justify-center",style:{height:"220px"},children:e.jsx("div",{className:"text-slate-500",children:"Data aktivasi tidak tersedia"})}):e.jsx("div",{style:{height:"220px"},children:e.jsx(J,{width:"100%",height:220,children:e.jsxs(fe,{data:v,children:[e.jsx(je,{strokeDasharray:"3 3",stroke:"#475569"}),e.jsx(F,{dataKey:"month",tick:{fill:"#94a3b8",fontSize:11}}),e.jsx(ie,{tick:{fill:"#94a3b8",fontSize:11}}),e.jsx(_,{contentStyle:{backgroundColor:"#1e293b",border:"2px solid #3b82f6",borderRadius:"8px",padding:"6px 10px"},labelStyle:{color:"#e2e8f0",fontSize:"11px",fontWeight:"bold"},itemStyle:{color:"#93c5fd",fontSize:"11px"}}),e.jsx(be,{type:"monotone",dataKey:"count",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",r:4}})]})})})]}),e.jsxs("div",{className:O(ke("blue",!0),"min-h-[340px]"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:A.heading4,children:"Distribusi Usia Mesin"}),e.jsx("p",{className:A.mutedSmall,children:"Berdasarkan tahun instalasi"})]}),e.jsx("button",{onClick:()=>y("machine-age"),className:"text-slate-400 hover:text-blue-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-blue-600/20 hover:bg-blue-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]}),e.jsx("div",{style:{height:"220px"},children:e.jsx(J,{width:"100%",height:220,children:e.jsxs(ge,{data:Ce,children:[e.jsx(je,{strokeDasharray:"3 3",stroke:"#475569"}),e.jsx(F,{dataKey:"range",tick:{fill:"#94a3b8",fontSize:11},angle:-15,textAnchor:"end",height:60}),e.jsx(ie,{tick:{fill:"#94a3b8",fontSize:11}}),e.jsx(_,{contentStyle:{backgroundColor:"#1e293b",border:"2px solid #3b82f6",borderRadius:"8px",padding:"6px 10px"},labelStyle:{color:"#e2e8f0",fontSize:"11px",fontWeight:"bold"},itemStyle:{color:"#93c5fd",fontSize:"11px"}}),e.jsx(pe,{dataKey:"count",fill:"#3b82f6",radius:[6,6,0,0]})]})})})]}),e.jsxs("div",{className:O(ke("green",!0),"min-h-[340px]"),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:A.heading4,children:"Trend Instalasi per Tahun"}),e.jsx("p",{className:A.mutedSmall,children:"Growth mesin over time"})]}),e.jsx("button",{onClick:()=>y("install-year"),className:"text-slate-400 hover:text-green-400 transition-colors p-2 rounded hover:bg-slate-700/50 bg-green-600/20 hover:bg-green-600/30",title:"Lihat Insight Detail",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]}),e.jsx("div",{style:{height:"220px"},children:e.jsx(J,{width:"100%",height:220,children:e.jsxs(fe,{data:Ee,children:[e.jsx(je,{strokeDasharray:"3 3",stroke:"#475569"}),e.jsx(F,{dataKey:"year",tick:{fill:"#94a3b8",fontSize:11}}),e.jsx(ie,{tick:{fill:"#94a3b8",fontSize:11}}),e.jsx(_,{contentStyle:{backgroundColor:"#1e293b",border:"2px solid #10b981",borderRadius:"8px",padding:"6px 10px"},labelStyle:{color:"#e2e8f0",fontSize:"11px",fontWeight:"bold"},itemStyle:{color:"#6ee7b7",fontSize:"11px"}}),e.jsx(be,{type:"monotone",dataKey:"count",stroke:"#10b981",strokeWidth:3,dot:{fill:"#10b981",r:4}})]})})})]})]}),e.jsx(l.Suspense,{fallback:e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}),children:E&&E!=="map"&&e.jsx(Tt,{chartType:E,onClose:()=>y(null),filteredMachines:M,filteredEngineers:R,experienceData:et,skillsData:tt,trainingData:st,warrantyData:at,machineAgeData:Ce,installYearData:Ee,currentMachines:B,currentEngineers:U,totalMachines:He,totalEngineers:ee,currentRatio:g,efficiencyPercentage:Te,loadPercentage:Re,machinesByRegion:W,engineersByRegion:q,machinesByAreaGroup:_e,machinesByVendor:Fe,engineersByAreaGroup:Ve,onEngineerClick:ve,warrantyPercentage:f,onWarranty:X,outOfWarranty:re,warrantyRemaining:I})}),ce&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[9999] flex items-center justify-center p-4",style:{zIndex:9999},onClick:()=>Z(!1),children:e.jsxs("div",{className:"bg-slate-800 rounded-xl max-w-5xl w-full max-h-[90vh] overflow-y-auto border border-slate-700",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-slate-800 border-b border-slate-700 p-6 flex justify-between items-center z-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-100",children:"üìä Insights Aktivasi Mesin"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["Analisis mendalam trend aktivasi mesin dari ",(Ie=v[0])==null?void 0:Ie.month," hingga ",(Ue=v[v.length-1])==null?void 0:Ue.month]})]}),e.jsx("button",{onClick:()=>Z(!1),className:"text-slate-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:`bg-gradient-to-br ${x?"from-blue-500/30 via-blue-400/20 to-indigo-500/30 border-blue-400/40":"from-blue-100 via-blue-50 to-indigo-100 border-blue-300"} p-4 rounded-lg border shadow-lg ${x?"shadow-blue-500/20":"shadow-blue-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"üéØ"}),e.jsx("p",{className:`text-sm ${x?"text-slate-300":"text-gray-700"}`,children:"Total Mesin Aktif"})]}),e.jsx("h3",{className:`text-3xl font-bold ${x?"text-blue-300":"text-blue-600"}`,children:L.total.toLocaleString()}),e.jsx("p",{className:`text-xs ${x?"text-slate-400":"text-gray-600"} mt-1`,children:"saat ini"})]}),e.jsxs("div",{className:`bg-gradient-to-br ${x?"from-emerald-500/30 via-green-400/20 to-teal-500/30 border-emerald-400/40":"from-emerald-100 via-green-50 to-teal-100 border-emerald-300"} p-4 rounded-lg border shadow-lg ${x?"shadow-emerald-500/20":"shadow-emerald-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"üìà"}),e.jsx("p",{className:`text-sm ${x?"text-slate-300":"text-gray-700"}`,children:"Pertumbuhan Total"})]}),e.jsxs("h3",{className:`text-3xl font-bold ${x?"text-emerald-300":"text-emerald-600"}`,children:["+",L.growthRateFormatted]}),e.jsx("p",{className:`text-xs ${x?"text-slate-400":"text-gray-600"} mt-1`,children:"sejak awal"})]}),e.jsxs("div",{className:`bg-gradient-to-br ${x?"from-purple-500/30 via-purple-400/20 to-pink-500/30 border-purple-400/40":"from-purple-100 via-purple-50 to-pink-100 border-purple-300"} p-4 rounded-lg border shadow-lg ${x?"shadow-purple-500/20":"shadow-purple-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:"üèÜ"}),e.jsx("p",{className:`text-sm ${x?"text-slate-300":"text-gray-700"}`,children:"Puncak Tertinggi"})]}),e.jsx("h3",{className:`text-2xl font-bold ${x?"text-purple-300":"text-purple-600"}`,children:L.highest.count.toLocaleString()}),e.jsx("p",{className:`text-xs ${x?"text-slate-400":"text-gray-600"} mt-1`,children:L.highest.month})]}),e.jsxs("div",{className:`bg-gradient-to-br ${x?"from-orange-500/30 via-amber-400/20 to-yellow-500/30 border-orange-400/40":"from-orange-100 via-amber-50 to-yellow-100 border-orange-300"} p-4 rounded-lg border shadow-lg ${x?"shadow-orange-500/20":"shadow-orange-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"text-2xl",children:L.recentTrend==="growing"?"üöÄ":L.recentTrend==="declining"?"üìâ":"‚û°Ô∏è"}),e.jsx("p",{className:`text-sm ${x?"text-slate-300":"text-gray-700"}`,children:"Trend Terkini"})]}),e.jsx("h3",{className:`text-2xl font-bold ${x?"text-orange-300":"text-orange-600"} capitalize`,children:L.recentTrend==="growing"?"Naik":L.recentTrend==="declining"?"Turun":"Stabil"}),e.jsx("p",{className:`text-xs ${x?"text-slate-400":"text-gray-600"} mt-1`,children:"6 bulan terakhir"})]})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-4",children:"üìà Trend Aktivasi Historis"}),e.jsx(J,{width:"100%",height:350,children:e.jsxs(fe,{data:v,children:[e.jsx(je,{strokeDasharray:"3 3",stroke:"#475569"}),e.jsx(F,{dataKey:"month",tick:{fill:"#94a3b8",fontSize:10},stroke:"#64748b",angle:-45,textAnchor:"end",height:80}),e.jsx(ie,{tick:{fill:"#94a3b8",fontSize:11},stroke:"#64748b"}),e.jsx(_,{contentStyle:{backgroundColor:"#1e293b",border:"2px solid #3b82f6",borderRadius:"12px"},labelStyle:{color:"#e2e8f0",fontWeight:"bold"},itemStyle:{color:"#60a5fa"},formatter:t=>[t.toLocaleString()+" mesin","Total Aktif"]}),e.jsx(be,{type:"monotone",dataKey:"count",stroke:"#3b82f6",strokeWidth:3,dot:{fill:"#3b82f6",r:3},activeDot:{r:6,stroke:"#1e293b",strokeWidth:2}})]})})]}),e.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-lg border border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-100 mb-4",children:"üí° Key Insights & Rekomendasi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex gap-3 items-start p-3 bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"text-2xl",children:"üìä"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-200 font-medium",children:"Pertumbuhan Eksponensial"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["Total mesin aktif telah tumbuh ",e.jsx("strong",{className:"text-green-400",children:L.growthRateFormatted})," sejak ",(We=v[0])==null?void 0:We.month,", menunjukkan adopsi yang sangat kuat dan konsisten."]})]})]}),e.jsxs("div",{className:"flex gap-3 items-start p-3 bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"text-2xl",children:"üéØ"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-200 font-medium",children:"Peak Performance"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["Aktivasi tertinggi tercatat pada ",e.jsx("strong",{className:x?"text-purple-300":"text-purple-600",children:L.highest.month})," dengan",e.jsxs("strong",{className:"text-purple-400",children:[" ",L.highest.count.toLocaleString()," mesin"]})," aktif."]})]})]}),e.jsxs("div",{className:"flex gap-3 items-start p-3 bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"text-2xl",children:"üìÖ"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-200 font-medium",children:"Maintenance Planning"}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["Dengan ",L.total.toLocaleString()," mesin aktif, prioritaskan preventive maintenance schedule untuk memastikan uptime optimal di semua lokasi."]})]})]}),e.jsxs("div",{className:"flex gap-3 items-start p-3 bg-slate-800/50 rounded-lg",children:[e.jsx("span",{className:"text-2xl",children:L.recentTrend==="growing"?"üöÄ":L.recentTrend==="declining"?"‚ö†Ô∏è":"‚û°Ô∏è"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-200 font-medium",children:"Trend Analysis"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:L.recentTrend==="growing"?"Trend aktivasi menunjukkan pertumbuhan positif 6 bulan terakhir. Pastikan resource dan support team mencukupi.":L.recentTrend==="declining"?"Trend menunjukkan penurunan aktivasi. Review faktor-faktor yang mempengaruhi dan lakukan improvement action.":"Trend stabil. Monitor terus untuk memastikan konsistensi operasional dan identifikasi opportunity untuk growth."})]})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 p-4 rounded-lg border border-blue-500/30",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-100 mb-3 flex items-center gap-2",children:[e.jsx("span",{children:"üéØ"})," Action Items & Next Steps"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-300",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"‚ñ∏"}),e.jsx("span",{children:"Lakukan capacity planning berdasarkan trend pertumbuhan untuk antisipasi kebutuhan engineer dan spare parts"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"‚ñ∏"}),e.jsx("span",{children:"Analisis pola seasonal untuk optimasi deployment resources di bulan-bulan dengan aktivasi tinggi"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"‚ñ∏"}),e.jsx("span",{children:"Setup monitoring dashboard real-time untuk track aktivasi harian dan identify anomali lebih cepat"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-400 mt-0.5",children:"‚ñ∏"}),e.jsx("span",{children:"Review historical data untuk understand correlation antara aktivasi mesin dengan faktor eksternal (seasonality, campaign, dll)"})]})]})]})]})]})}),xe&&m&&m.expiringSoonMachines&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-6",style:{zIndex:9999},children:e.jsxs("div",{className:"bg-slate-900 rounded-xl w-full max-w-5xl max-h-[90vh] flex flex-col border border-slate-700 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," Top 5 Mesin yang Expiring Soon"]}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["Menampilkan 5 dari ",m.expiringSoonMachines.length," mesin dengan status critical"]})]}),e.jsx("button",{onClick:()=>n(!1),className:"text-slate-400 hover:text-white transition-colors p-2 rounded hover:bg-slate-800",children:e.jsx(we,{size:24})})]}),e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("th",{className:"text-left py-3 px-4 text-slate-400 font-semibold",children:"#"}),e.jsx("th",{className:"text-left py-3 px-4 text-slate-400 font-semibold",children:"WSID"}),e.jsx("th",{className:"text-left py-3 px-4 text-slate-400 font-semibold",children:"Nama Mesin"}),e.jsx("th",{className:"text-left py-3 px-4 text-slate-400 font-semibold",children:"Area"}),e.jsx("th",{className:"text-left py-3 px-4 text-slate-400 font-semibold",children:"Customer"}),e.jsx("th",{className:"text-left py-3 px-4 text-slate-400 font-semibold",children:"Region"}),e.jsx("th",{className:"text-right py-3 px-4 text-slate-400 font-semibold",children:"Sisa Hari"}),e.jsx("th",{className:"text-center py-3 px-4 text-slate-400 font-semibold",children:"Status"})]})}),e.jsx("tbody",{children:m.expiringSoonMachines.slice(0,5).map((t,s)=>e.jsxs("tr",{className:"border-b border-slate-700/50 hover:bg-slate-800/50 transition-colors",children:[e.jsxs("td",{className:"py-3 px-4 text-slate-300 font-bold text-red-400",children:["#",s+1]}),e.jsx("td",{className:"py-3 px-4 text-slate-200 font-mono text-sm",children:t.wsid}),e.jsx("td",{className:"py-3 px-4 text-slate-200 font-semibold",children:t.branch_name||"Unknown"}),e.jsx("td",{className:"py-3 px-4 text-slate-300",children:t.area_group||"Unknown"}),e.jsx("td",{className:"py-3 px-4 text-slate-300",children:t.customer||"Unknown"}),e.jsx("td",{className:"py-3 px-4 text-slate-300",children:t.region||"Unknown"}),e.jsxs("td",{className:"py-3 px-4 text-right",children:[e.jsx("div",{className:`font-bold text-lg ${t.warrantyInfo.days<=30?"text-red-400":t.warrantyInfo.days<=60?"text-orange-400":"text-yellow-400"}`,children:t.warrantyInfo.days}),e.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:t.warrantyInfo.months>0?`${t.warrantyInfo.months} bulan`:"< 1 bulan"})]}),e.jsx("td",{className:"py-3 px-4 text-center",children:e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-red-500/20 text-red-400 font-semibold",children:"Critical"})})]},s))})]})})})]})}),H&&m&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-6",style:{zIndex:9999},children:e.jsxs("div",{className:"bg-slate-900 rounded-xl w-full max-w-6xl max-h-[90vh] flex flex-col border border-slate-700 shadow-2xl",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-700",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx("span",{children:"üìä"})," Insight Detail Warranty"]}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:["Analisis lengkap status warranty ",m.totalOnWarranty," mesin"]})]}),e.jsx("button",{onClick:()=>de(!1),className:"text-slate-400 hover:text-white transition-colors p-2 rounded hover:bg-slate-800",children:e.jsx(we,{size:24})})]}),e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Total On Warranty"}),e.jsx("p",{className:"text-2xl font-bold text-green-400",children:m.totalOnWarranty})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-slate-700",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Rata-rata Sisa"}),e.jsx("p",{className:"text-2xl font-bold text-blue-400",children:(($e=m.avgRemaining)==null?void 0:$e.avgMonths)>0?`${m.avgRemaining.avgMonths} bulan`:`${((Be=m.avgRemaining)==null?void 0:Be.avgDays)||0} hari`})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-red-500/30",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Expiring Soon"}),e.jsx("p",{className:"text-2xl font-bold text-red-400",children:m.expiringSoonMachines.length}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"< 90 hari"})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-yellow-500/30",children:[e.jsx("p",{className:"text-slate-400 text-xs mb-1",children:"Warning"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:m.distribution.warning||0}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"90-180 hari"})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"üìä"})," Warranty Status Overview"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"w-full h-6 bg-slate-700/50 rounded-full overflow-hidden relative",children:[e.jsx("div",{className:"h-full bg-gradient-to-r from-green-500 to-green-400 transition-all duration-500 flex items-center justify-center",style:{width:`${f}%`},children:f>=20&&e.jsxs("span",{className:"text-xs font-bold text-white",children:[f.toFixed(1),"%"]})}),e.jsx("div",{className:"absolute top-0 right-0 h-full bg-gradient-to-r from-red-500/80 to-red-400/80 transition-all duration-500 flex items-center justify-center",style:{width:`${100-f}%`},children:100-f>=20&&e.jsxs("span",{className:"text-xs font-bold text-white",children:[(100-f).toFixed(1),"%"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 rounded-lg p-4 hover:bg-green-500/20 transition-colors",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-400 text-2xl",children:"‚úÖ"}),e.jsx("span",{className:"text-sm text-green-300 font-semibold",children:"On Warranty"})]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-4xl font-bold text-green-400",children:X.toLocaleString()}),e.jsx("span",{className:"text-lg text-green-300/70",children:"mesin"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-green-300/70",children:"Percentage"}),e.jsxs("span",{className:"text-green-400 font-bold",children:[f.toFixed(1),"%"]})]}),I&&I.avgMonths>0&&e.jsxs("div",{className:"flex items-center justify-between text-xs pt-2 border-t border-green-500/20",children:[e.jsx("span",{className:"text-green-300/70",children:"Avg. Remaining"}),e.jsxs("span",{className:"text-green-400 font-bold",children:[I.avgMonths," bulan"]})]})]})]}),e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4 hover:bg-red-500/20 transition-colors",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-red-400 text-2xl",children:"‚ö†Ô∏è"}),e.jsx("span",{className:"text-sm text-red-300 font-semibold",children:"Expired"})]})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-4xl font-bold text-red-400",children:re.toLocaleString()}),e.jsx("span",{className:"text-lg text-red-300/70",children:"mesin"})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-red-300/70",children:"Percentage"}),e.jsxs("span",{className:"text-red-400 font-bold",children:[(100-f).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs pt-2 border-t border-red-500/20",children:[e.jsx("span",{className:"text-red-300/70",children:"Status"}),e.jsx("span",{className:O("font-bold",100-f>70?"text-red-400":100-f>50?"text-yellow-400":"text-green-400"),children:100-f>70?"Critical":100-f>50?"High":"Normal"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 pt-4 border-t border-slate-700",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-slate-200",children:B.toLocaleString()}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Total Mesin"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-400",children:X.toLocaleString()}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Aktif"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-red-400",children:re.toLocaleString()}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Expired"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-slate-200 mb-4",children:"Distribusi Sisa Waktu Warranty"}),e.jsx(J,{width:"100%",height:250,children:e.jsxs(ge,{data:Object.entries(m.timeRanges).map(([t,s])=>({name:t,value:s})),children:[e.jsx(F,{dataKey:"name",tick:{fill:"#cbd5e1",fontSize:11}}),e.jsx(_,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #10b981",borderRadius:"8px"},labelStyle:{color:"#e2e8f0"}}),e.jsx(pe,{dataKey:"value",fill:"#10b981",radius:[4,4,0,0]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-red-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-red-400 font-semibold",children:"Critical"}),e.jsx("span",{className:"text-2xl font-bold text-red-400",children:m.distribution.critical||0})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Mesin dengan sisa < 90 hari"}),e.jsx("div",{className:"mt-2 w-full h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-500",style:{width:`${m.totalOnWarranty>0?m.distribution.critical/m.totalOnWarranty*100:0}%`}})})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-yellow-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-yellow-400 font-semibold",children:"Warning"}),e.jsx("span",{className:"text-2xl font-bold text-yellow-400",children:m.distribution.warning||0})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Mesin dengan sisa 90-180 hari"}),e.jsx("div",{className:"mt-2 w-full h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-yellow-500",style:{width:`${m.totalOnWarranty>0?m.distribution.warning/m.totalOnWarranty*100:0}%`}})})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-4 border border-green-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-green-400 font-semibold",children:"Good"}),e.jsx("span",{className:"text-2xl font-bold text-green-400",children:m.distribution.good||0})]}),e.jsx("p",{className:"text-xs text-slate-400",children:"Mesin dengan sisa > 180 hari"}),e.jsx("div",{className:"mt-2 w-full h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-500",style:{width:`${m.totalOnWarranty>0?m.distribution.good/m.totalOnWarranty*100:0}%`}})})]})]}),m.expiringSoonMachines.length>0&&e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-6 border border-slate-700",children:[e.jsxs("h3",{className:"text-lg font-semibold text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"‚ö†Ô∏è"})," Mesin yang Expiring Soon (Top 10)"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("th",{className:"text-left p-2 text-slate-400",children:"WSID"}),e.jsx("th",{className:"text-left p-2 text-slate-400",children:"Branch"}),e.jsx("th",{className:"text-left p-2 text-slate-400",children:"Customer"}),e.jsx("th",{className:"text-left p-2 text-slate-400",children:"Area"}),e.jsx("th",{className:"text-right p-2 text-slate-400",children:"Sisa Hari"}),e.jsx("th",{className:"text-right p-2 text-slate-400",children:"Status"})]})}),e.jsx("tbody",{children:m.expiringSoonMachines.map((t,s)=>e.jsxs("tr",{className:"border-b border-slate-700/50 hover:bg-slate-700/30",children:[e.jsx("td",{className:"p-2 text-slate-200 font-mono text-xs",children:t.wsid}),e.jsx("td",{className:"p-2 text-slate-300",children:t.branch_name}),e.jsx("td",{className:"p-2 text-slate-300",children:t.customer}),e.jsx("td",{className:"p-2 text-slate-300",children:t.area_group}),e.jsx("td",{className:"p-2 text-right",children:e.jsxs("span",{className:"text-red-400 font-semibold",children:[t.warrantyInfo.days," hari"]})}),e.jsx("td",{className:"p-2 text-right",children:e.jsx("span",{className:"px-2 py-1 rounded text-xs bg-red-500/20 text-red-400",children:"Critical"})})]},s))})]})})]})]})]})})]})}const Ot=Object.freeze(Object.defineProperty({__proto__:null,default:Rt},Symbol.toStringTag,{value:"Module"}));export{Ot as D,Pe as M};
