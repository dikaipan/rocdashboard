import{r as i,j as e,X as T,z as E,a4 as z,$ as O,a0 as P}from"./vendor-react-C0jbZujj.js";import"./vendor-maps-C_U1R0uQ.js";function M({isOpen:y,onClose:w,alertData:u,onEdit:k}){const[h,g]=i.useState(""),[d,N]=i.useState("all"),[C,v]=i.useState({}),n=i.useMemo(()=>{const t={};return u.entries.forEach(a=>{const s=a.part.part_number||a.part["part number"];t[s]||(t[s]={part:a.part,fslList:[]}),t[s].fslList.push({name:a.fslName,stock:a.stock})}),Object.values(t).forEach(a=>{a.fslList.sort((s,l)=>s.stock-l.stock)}),t},[u.entries]),p=i.useMemo(()=>Object.values(n).filter(t=>{const a=t.part,s=(a.part_number||a["part number"]||"").toLowerCase(),l=(a.part_name||a["part name"]||"").toLowerCase(),f=(a.type_of_part||a["type of part"]||"").toLowerCase().trim(),j=(a["20_top_usage"]||a["20 top usage"]||"").toLowerCase()==="yes",x=h.toLowerCase().trim(),c=!x||s.includes(x)||l.includes(x);let o=!0;return d==="all"?o=!0:d==="top20"?o=j:o=f===d.toLowerCase().trim(),c&&o}),[n,h,d]),L=i.useMemo(()=>[...new Set(Object.values(n).map(t=>t.part.type_of_part||t.part["type of part"]||"Other"))].filter(Boolean).sort(),[n]),b=()=>{g(""),N("all"),v({}),w()},_=t=>{k(t),b()};return y?e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-6",style:{zIndex:9999},children:e.jsxs("div",{className:"bg-slate-900 rounded-xl w-full max-w-6xl max-h-[90vh] flex flex-col border border-slate-700",children:[e.jsxs("div",{className:"p-6 border-b border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:u.title}),e.jsxs("p",{className:"text-sm text-slate-400 mt-1",children:[p.length," parts ",p.length!==Object.values(n).length&&`(of ${Object.values(n).length})`," memerlukan perhatian"]})]}),e.jsx("button",{onClick:b,className:"text-slate-400 hover:text-white transition-colors",children:e.jsx(T,{size:24})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search part number or name...",value:h,onChange:t=>g(t.target.value),className:"pl-10 pr-4 py-2 w-full bg-slate-800 border border-slate-700 rounded-lg text-slate-300 focus:outline-none focus:border-blue-500 text-sm"})]}),e.jsxs("select",{value:d,onChange:t=>N(t.target.value),className:"px-4 py-2 bg-slate-800 border border-slate-700 rounded-lg text-slate-300 focus:outline-none focus:border-blue-500 text-sm min-w-[180px]",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"top20",children:"⭐ Top 20 Only"}),L.map(t=>e.jsx("option",{value:t.toLowerCase(),children:t},t))]})]})]}),e.jsx("div",{className:"flex-1 p-6 overflow-auto",children:e.jsxs("div",{className:"space-y-2",children:[p.map((t,a)=>{const s=t.part,l=s.part_number||s["part number"]||"-",f=s.part_name||s["part name"]||"-",j=s.type_of_part||s["type of part"]||"Other",x=(s["20_top_usage"]||s["20 top usage"]||"").toLowerCase()==="yes",c=parseInt(s.grand_total||s["grand total"]||0),o=C[l];return e.jsxs("div",{className:"bg-slate-800/50 rounded-lg border border-slate-700 hover:border-slate-600 transition-all",children:[e.jsx("div",{className:"p-4 cursor-pointer flex items-center justify-between",onClick:()=>v(r=>({...r,[l]:!r[l]})),children:e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx("div",{className:"text-slate-400",children:o?e.jsx(z,{size:16,className:"rotate-[-90deg]"}):e.jsx(O,{size:16})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm font-bold text-blue-400",children:l}),x&&e.jsx("span",{className:"text-yellow-400",title:"Top 20 Usage",children:"⭐"}),e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-purple-500/20 text-purple-400",children:j})]}),e.jsx("div",{className:"text-sm text-slate-300",children:f})]}),e.jsxs("div",{className:"text-center px-4",children:[e.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"Total Stock"}),e.jsx("span",{className:`text-lg font-bold ${c===0?"text-red-400":c<=5?"text-orange-400":c<=10?"text-yellow-400":"text-cyan-400"}`,children:c})]}),e.jsx("div",{className:"px-3 py-1 bg-slate-700 rounded-full",children:e.jsxs("span",{className:"text-xs font-semibold text-slate-300",children:[t.fslList.length," FSL",t.fslList.length>1?"s":""]})}),e.jsxs("button",{onClick:r=>{r.stopPropagation(),_(s)},className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-medium transition-colors flex items-center gap-1",title:"Edit Stock",children:[e.jsx(P,{size:12})," Edit"]})]})}),o&&e.jsx("div",{className:"px-4 pb-4 border-t border-slate-700",children:e.jsxs("div",{className:"pt-3",children:[e.jsx("div",{className:"text-xs font-semibold text-slate-400 mb-2",children:"FSL Locations (sorted by stock level):"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:t.fslList.map((r,S)=>{let m="bg-cyan-500/20 text-cyan-400 border-cyan-500/30";return r.stock===0?m="bg-red-500/20 text-red-400 border-red-500/30":r.stock>=1&&r.stock<=5?m="bg-orange-500/20 text-orange-400 border-orange-500/30":r.stock>=6&&r.stock<=10&&(m="bg-yellow-500/20 text-yellow-400 border-yellow-500/30"),e.jsxs("div",{className:`px-3 py-2 rounded-lg border ${m} flex items-center justify-between`,children:[e.jsx("span",{className:"text-xs font-medium",children:r.name}),e.jsx("span",{className:"text-sm font-bold",children:r.stock})]},S)})})]})})]},a)}),p.length===0&&e.jsx("div",{className:"text-center py-12",children:e.jsx("div",{className:"text-slate-400 text-sm",children:"No parts found matching your filters."})})]})}),e.jsxs("div",{className:"flex justify-between items-center p-6 border-t border-slate-700",children:[e.jsx("div",{className:"text-sm text-slate-400",children:"Click on a part to expand FSL details"}),e.jsx("button",{onClick:b,className:"px-6 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:"Close"})]})]})}):null}export{M as default};
