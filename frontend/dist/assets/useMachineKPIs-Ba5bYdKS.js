import{r as D}from"./vendor-react-C0jbZujj.js";import{a as x}from"./textUtils-DatDPYXU.js";function _(r,u=2){if(!r)return{days:0,months:0,years:0,expired:!0,status:"expired"};const i=parseInt(r)||new Date().getFullYear(),c=new Date,l=new Date(i+u,11,31)-c,a=Math.ceil(l/(1e3*60*60*24));if(a<0)return{days:0,months:0,years:0,expired:!0,status:"expired"};const s=Math.floor(a/365),m=Math.floor(a%365/30),g=a%30;let o="good";return a<90?o="critical":a<180&&(o="warning"),{days:g,months:m,years:s,expired:!1,status:o,totalDays:a}}function v(r,u,i=2){return D.useMemo(()=>{const c=r.length,p=r.filter(t=>t.machine_status==="On Warranty"||t.machine_status==="In Warranty").length,l=r.filter(t=>t.machine_status==="Out Of Warranty"||t.machine_status&&t.machine_status.toLowerCase().includes("expired")).length,a=r.filter(t=>t.machine_status==="On Warranty"||t.machine_status==="In Warranty").map(t=>_(t.year,i)).filter(t=>!t.expired),s=a.length>0?Math.round(a.reduce((t,n)=>t+n.totalDays,0)/a.length):0,m=a.reduce((t,n)=>(t[n.status]=(t[n.status]||0)+1,t),{critical:0,warning:0,good:0}),g=a.filter(t=>t.status==="critical").length,o=r.reduce((t,n)=>{const e=n.maintenance_status||"Unknown";return t[e]=(t[e]||0)+1,t},{}),h=r.reduce((t,n)=>{const e=n.area_group||"Unknown",y=x(e);return t[y]=(t[y]||0)+1,t},{}),d=Object.entries(h).sort((t,n)=>n[1]-t[1]).slice(0,3),f=r.reduce((t,n)=>{const e=n.customer||"Unknown";return t[e]=(t[e]||0)+1,t},{}),w=Object.entries(f).map(([t,n])=>({name:t,value:n})).sort((t,n)=>n.value-t.value).slice(0,3);return{totalMachines:c,totalAllMachines:u.length,onWarranty:p,outOfWarranty:l,warrantyRemaining:{avgDays:s,avgMonths:Math.round(s/30),avgYears:Math.round(s/365),expiringSoon:g,statusCounts:m},maintenanceStats:o,topAreaGroups:d,topCustomers:w}},[r,u,i])}export{v as u};
